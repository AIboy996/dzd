+++
title = '全概率公式'
date = 2025-03-15T22:36:34+08:00
draft = false
tags = ["概率"]
+++

## 已知

考虑小A打游戏的问题。

- 如果小A某一天没打游戏，那么第二天打游戏的概率为0.5
- 如果小A某一天打了游戏，那么第二天继续打游戏的概率为0.4

假设第0天小A没打游戏，问第n天小A打游戏的概率$P_n$是多少？
<!--more-->

## 题解

第n天打游戏的概率实际上取决于前一天打没打游戏。

我们可以使用Bayes全概率公式：

$$
\begin{aligned}
P_n = &P(\text{第n天打游戏}\mid \text{第n-1天打游戏})P(\text{第n-1天打游戏}) \\\\
&+ P(\text{第n天打游戏}\mid \text{第n-1天没打游戏})P(\text{第n-1天没打游戏})
\end{aligned}
$$

于是得到递推公式：
$$
P_n = 0.4P_{n-1}+0.5(1-P_{n-1})
$$
也就是：
$$
P_n = 0.5-0.1P_{n-1}
$$
这种类型的递推公式可以考虑两边同时除以$(-0.1)^n$：
$$
\frac{P_n}{(-0.1)^n} = \frac{0.5}{(-0.1)^n} + \frac{P_{n-1}}{(-0.1)^{n-1}}
$$

所以：
$$
\frac{P_n}{(-0.1)^n} - \frac{P_{n-1}}{(-0.1)^{n-1}} = \frac{0.5}{(-0.1)^n}
$$
直接两边累加得到：
$$
\begin{aligned}
&\left[\frac{P_n}{(-0.1)^n} - \frac{P_{n-1}}{(-0.1)^{n-1}}\right] \\\\
&+ \left[\frac{P_{n-1}}{(-0.1)^{n-1}} - \frac{P_{n-2}}{(-0.1)^{n-2}}\right]\\\\
&+\cdots+\left[\frac{P_2}{(-0.1)^2} - \frac{P_{1}}{(-0.1)^{1}}\right] \\\\
&= \sum_{k=2}^n \frac{0.5}{(-0.1)^k}\\\\
&=\frac{50(1-(-10)^{n-1})}{11}
\end{aligned}
$$
也就是：
$$
\frac{P_n}{(-0.1)^n} +10P_1 = \frac{50+5\cdot (-10)^{n}}{11}
$$
最终得到：
$$
P_n = \frac{5 - 5\cdot (-0.1)^n}{11}
$$

## 另外一题

其实此类题非常多，再举一例读者可以动手算一算：

棋盘上标有第$0,1,2\cdots,100$站。棋子开始时位于第0站，棋手抛掷均匀硬币来走跳棋。

- 如果抛出正面，棋子前进两站
- 如果抛出反面，棋子前进一站

走到100或者99站的时候游戏结束。

求游戏过程中，棋子**经过第n站**的概率$P_n,\quad n\le 1 \le 100$。

> 这里经过的含义是棋子恰好位于第n站。在一次跳两站的情况下，有概率不经过第n站。所以这个概率小于一。

{{< collapse summary="💡提示">}}$$P_{n+1} = 0.5P_{n} +0.5P_{n-1}$${{</ collapse >}}
